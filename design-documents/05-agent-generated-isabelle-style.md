# Agent-Generated Isabelle Proof Style Guide

Status: Draft steering document  
Applies to: Isabelle text generated by `isabelle-assistant`  
Last reviewed: 2026-02-21

## Purpose

This guide defines proof engineering quality expected from generated Isabelle output. It consolidates existing system prompt rules and conventions visible in high-quality project theories.

## Core Requirements

1. Never fabricate facts, theorem names, or proof states.
2. Prefer maintainable Isar structure over brittle one-liners.
3. Keep edits local and minimal.
4. Avoid placeholders (`sorry`, `oops`) unless explicitly requested.

## Structural Style

Preferred defaults:

- Use structured `proof - ... qed` blocks.
- Prefer hypothetical blocks `{ ... }` when clearer than nested inner proofs.
- Use `have`, `then`, `from`, `moreover`, `ultimately` for readable flow.
- Name and reuse assumptions explicitly.

## Statement Style

- Use `assumes`/`fixes`/`shows` forms where appropriate.
- Prefer `and` chaining for multiple assumptions or fixed variables.
- Follow local naming conventions for theorem families.

## Automation Discipline

- Use `simp`, `auto`, `blast`, `metis` intentionally.
- Do not default to opaque `metis`/`smt` when a short readable derivation exists.
- Control simplification context explicitly when needed.

## Formatting Requirements

- Two-space indentation.
- Keep proof text for a claim on the following indented line.
- Exactly one blank line between top-level declarations.
- Preserve surrounding file style when editing existing sections.

## Documentation and Narrative

- Use `text<...>` or cartouche comments for narrative context.
- Keep comments factual and useful for proof maintenance.

## Verification Discipline

Before declaring proof completion:

1. inspect goal/context with tools.
2. validate candidate proof steps with verification tools.
3. ensure diagnostics are clean at end-of-file processing.

## Chat Output Conventions

For responses intended for insertion:

- Use fenced `isabelle` code blocks.
- Use Markdown and LaTeX where helpful.
- Mermaid diagrams are acceptable when they clarify proof structure.

## Acceptance Checks

Generated Isabelle output is acceptable only when:

1. It compiles/checks without placeholders (unless requested).
2. It follows local style and this guide.
3. It is understandable without reverse-engineering opaque automation.
